(function(e){function t(t){for(var a,r,c=t[0],s=t[1],i=t[2],d=0,f=[];d<c.length;d++)r=c[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);l&&l(t);while(f.length)f.shift()();return u.push.apply(u,i||[]),n()}function n(){for(var e,t=0;t<u.length;t++){for(var n=u[t],a=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(a=!1)}a&&(u.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={"app~d0ae3f07":0},o={"app~d0ae3f07":0},u=[];function c(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-00533f42":"c1f139cb","chunk-021e05bd":"722c98ce","chunk-276f3cec":"2b731903","chunk-2840293a":"c1a0413f","chunk-3d3fd650":"ea4af0fb","chunk-5192e821":"78e34b7e","chunk-551f9e93":"04f70cda","chunk-8d20de52":"95863f27"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-00533f42":1,"chunk-021e05bd":1,"chunk-276f3cec":1,"chunk-2840293a":1,"chunk-3d3fd650":1,"chunk-5192e821":1,"chunk-551f9e93":1,"chunk-8d20de52":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-00533f42":"bd2ab6e0","chunk-021e05bd":"27828a15","chunk-276f3cec":"215f1269","chunk-2840293a":"215f1269","chunk-3d3fd650":"b175ea01","chunk-5192e821":"20287046","chunk-551f9e93":"1f4150b3","chunk-8d20de52":"215f1269"}[e]+".css",o=s.p+a,u=document.getElementsByTagName("link"),c=0;c<u.length;c++){var i=u[c],d=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(d===a||d===o))return t()}var f=document.getElementsByTagName("style");for(c=0;c<f.length;c++){i=f[c],d=i.getAttribute("data-href");if(d===a||d===o)return t()}var l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.onload=t,l.onerror=function(t){var a=t&&t.target&&t.target.src||o,u=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");u.code="CSS_CHUNK_LOAD_FAILED",u.request=a,delete r[e],l.parentNode.removeChild(l),n(u)},l.href=o;var h=document.getElementsByTagName("head")[0];h.appendChild(l)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var u=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=u);var i,d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=c(e);var f=new Error;i=function(t){d.onerror=d.onload=null,clearTimeout(l);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",f.name="ChunkLoadError",f.type=a,f.request=r,n[1](f)}o[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:d})}),12e4);d.onerror=d.onload=i,document.head.appendChild(d)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var f=0;f<i.length;f++)t(i[f]);var l=d;u.push([0,"chunk-vendors~253ae210","chunk-vendors~b58f7129"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.layout,{tag:"component"},[n("router-view")],1)},o=[],u={computed:{layout:function(){return this.$route.meta.layout||"default-layout"}}},c=u,s=(n("5c0b"),n("2877")),i=Object(s["a"])(c,r,o,!1,null,null,null),d=i.exports,f=n("1da1"),l=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("8c4f")),h=n("f121");a["a"].use(l["a"]);var m=[{path:"/",name:"index",component:function(){return n.e("chunk-551f9e93").then(n.bind(null,"3cb4"))}},{path:"/live/",name:"live",component:function(){return n.e("chunk-5192e821").then(n.bind(null,"ddee"))},meta:{layout:"empty-layout"}},{path:"/team/:id/",name:"team",component:function(){return n.e("chunk-00533f42").then(n.bind(null,"4dbc"))}},{path:"/admin/login/",name:"adminLogin",component:function(){return n.e("chunk-2840293a").then(n.bind(null,"23b1"))}},{path:"/admin/",name:"admin",component:function(){return n.e("chunk-021e05bd").then(n.bind(null,"f225"))},meta:{auth:!0}},{path:"/admin/task/:id/",name:"taskAdmin",component:function(){return n.e("chunk-276f3cec").then(n.bind(null,"b022"))},meta:{auth:!0}},{path:"/admin/team/:id/",name:"teamAdmin",component:function(){return n.e("chunk-8d20de52").then(n.bind(null,"e38e"))},meta:{auth:!0}},{path:"/admin/create_task/",name:"createTask",component:function(){return n.e("chunk-276f3cec").then(n.bind(null,"b022"))},meta:{auth:!0}},{path:"/admin/create_team/",name:"createTeam",component:function(){return n.e("chunk-8d20de52").then(n.bind(null,"e38e"))},meta:{auth:!0}},{path:"/admin/teamtask_log/team/:teamId/task/:taskId/",name:"adminTeamTaskLog",component:function(){return n.e("chunk-3d3fd650").then(n.bind(null,"a4ee"))},meta:{auth:!0}}],p=new l["a"]({mode:"history",base:"/",routes:m});p.beforeEach(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t,n,a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.meta.auth){e.next=14;break}return r=!1,e.prev=2,e.next=5,p.$http.get("".concat(h["d"],"/api/admin/status/"));case 5:r=!0,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),a({name:"adminLogin"});case 11:r&&a(),e.next=15;break;case 14:a();case 15:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,a){return e.apply(this,arguments)}}());var b=p,v=n("bc3a"),k=n.n(v),g=n("5530"),y=(n("4160"),n("159b"),n("4e82"),n("0d03"),n("d81d"),n("2f62")),_=n("0e44"),w=n("b85c"),T=n("d4ec"),O=n("bee2"),j=(n("b0c0"),n("4de4"),n("13d5"),n("caad"),n("2532"),n("de4d")),P=function(){function e(t){var n=t.name,a=t.ip,r=t.id,o=t.teamTasks,u=t.tasks,c=t.highlighted;Object(T["a"])(this,e),this.name=n,this.ip=a,this.id=r,this.highlighted=c,this.taskModels=u,this.update(o)}return Object(O["a"])(e,[{key:"update",value:function(e){var t=this;this.tasks=e.filter((function(e){var n=e.teamId;return n===t.id})),this.score=this.tasks.reduce((function(e,t){var n=t.score,a=t.sla;return e+n*(a/100)}),0);var n,a=this.tasks.map((function(e){return e.taskId})),r=Object(w["a"])(this.taskModels);try{for(r.s();!(n=r.n()).done;){var o=n.value;a.includes(o.id)||this.tasks.push(new j["a"]({id:0,task_id:o.id,team_id:this.id,status:0,stolen:0,lost:0,score:0,checks:0,checks_passed:0}))}}catch(u){r.e(u)}finally{r.f()}this.tasks.sort(j["a"].comp)}}],[{key:"comp",value:function(e,t){return t.score-e.score}}]),e}(),S=P,x=n("f1a4");a["a"].use(y["a"]);var R=new y["a"].Store({plugins:[Object(_["a"])({paths:["showPonies"]})],state:{round:0,roundTime:null,roundStart:null,roundProgress:null,teams:null,tasks:null,teamTasks:null,showPonies:!0,layout:"default-layout"},mutations:{setRound:function(e,t){e.round=t},setRoundStart:function(e,t){e.roundStart=t},setRoundTime:function(e,t){e.roundTime=t},setRoundProgress:function(e,t){e.roundProgress=t},setTeams:function(e,t){e.teams=t},setTasks:function(e,t){e.tasks=t},setGameState:function(e,t){e.round=t.round,e.roundStart=t.roundStart,e.teamTasks=t.teamTasks},updateTeams:function(e){null!==e.teams&&(e.teams.forEach((function(t){t.update(e.teamTasks)})),e.teams=e.teams.sort(S.comp))},togglePonies:function(e){e.showPonies=!e.showPonies},setLayout:function(e,t){e.layout=t}},getters:{layout:function(e){return e.layout}},actions:{fetchRoundTime:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("/client/config/");case 2:n=e.sent,a=n.data.round_time,t.commit("setRoundTime",a);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),calculateRoundProgress:function(e){var t=e.state,n=t.round,a=t.roundTime,r=t.roundStart;(null===a||null===r||n<1)&&e.commit("setRoundProgress",null);var o=((new Date).getTime()/1e3-r-a)/a;o=Math.min(o,1),o=Math.floor(100*o),e.commit("setRoundProgress",o)},handleUpdateScoreboardMessage:function(e,t){var n=t.round,a=t.round_start,r=t.team_tasks;r=r.map((function(e){return new j["a"](e)}));var o={round:n,roundStart:a,teamTasks:r};e.commit("setGameState",o),e.commit("updateTeams")},handleInitScoreboardMessage:function(e,t){var n=t.state,a=t.teams,r=t.tasks;r=r.map((function(e){return new x["a"](e)})).sort(x["a"].comp),e.commit("setTasks",r),e.dispatch("handleUpdateScoreboardMessage",n),a=a.map((function(t){return new S(Object(g["a"])({teamTasks:e.state.teamTasks,tasks:e.state.tasks},t))})).sort(S.comp),e.commit("setTeams",a)}}}),C=R,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("header",[n("topbar")],1),n("container",[e._t("default")],2),e._m(0)],1)},$=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",{staticClass:"footer"},[e._v(" Powered by "),n("span",{staticClass:"team"},[e._v("C4T BuT S4D")]),e._v(" CTF team ")])}],M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e._t("default")],2)},I=[],L=(n("e5a0"),{}),A=Object(s["a"])(L,M,I,!1,null,"831e0c14",null),N=A.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"topbar"},[n("router-link",{staticClass:"tp",attrs:{to:"/live/"}},[e._v("Live")]),n("div",{staticClass:"progress-bar",style:{width:e.roundProgress+"%"}}),n("div",{staticClass:"tp"},[e._v("Round: "+e._s(e.round))])],1)},D=[],B=(n("4795"),{data:function(){return{timer:null}},created:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Creating timer"),e.next=3,this.$store.dispatch("fetchRoundTime");case 3:this.timer=setInterval((function(){return t.$store.dispatch("calculateRoundProgress")}),500);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),beforeRouteLeave:function(e,t,n){console.log("Destroying timer"),clearInterval(this.timer),n()},computed:Object(y["b"])(["round","roundProgress"])}),F=B,K=(n("7693"),Object(s["a"])(F,U,D,!1,null,"34ae2cec",null)),q=K.exports,G=n("8e27"),H=n.n(G),J={components:{Container:N,Topbar:q},data:function(){return{server:null}},created:function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.server=H()("".concat(h["d"],"/game_events"),{forceNew:!0}),this.server.on("connect_error",(function(){t.error="Can't connect to server"})),this.server.on("init_scoreboard",(function(e){var n=e.data;t.error=null,t.$store.dispatch("handleInitScoreboardMessage",n)})),this.server.on("update_scoreboard",(function(e){var n=e.data;t.error=null,t.$store.dispatch("handleUpdateScoreboardMessage",n)}));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},W=J,z=(n("d16c"),Object(s["a"])(W,E,$,!1,null,"4f40b6be",null)),Q=z.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e._t("default")],2)},X=[],Y=(n("ea97"),{}),Z=Object(s["a"])(Y,V,X,!1,null,null,null),ee=Z.exports;a["a"].config.productionTip=!1,k.a.defaults.baseURL=h["a"],k.a.defaults.withCredentials=!0,a["a"].prototype.$http=k.a,b.$http=k.a,C.$http=k.a,a["a"].component("default-layout",Q),a["a"].component("empty-layout",ee),new a["a"]({router:b,store:C,render:function(e){return e(d)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"5dc6":function(e,t,n){},7693:function(e,t,n){"use strict";n("7e6b")},"7e6b":function(e,t,n){},"9c0c":function(e,t,n){},b071:function(e,t,n){},d16c:function(e,t,n){"use strict";n("b071")},de4d:function(e,t,n){"use strict";var a=n("d4ec"),r=n("bee2"),o=function(){function e(t){var n=t.id,r=t.task_id,o=t.team_id,u=t.status,c=t.stolen,s=t.lost,i=t.score,d=t.checks,f=t.checks_passed,l=t.message;Object(a["a"])(this,e),this.id=n,this.taskId=r,this.teamId=o,this.status=u,this.stolen=c,this.lost=s,this.sla=100*f/Math.max(d,1),this.score=i,this.message=""===l&&101==this.status?"OK":l}return Object(r["a"])(e,null,[{key:"comp",value:function(e,t){return e.taskId-t.taskId}}]),e}();t["a"]=o},e5a0:function(e,t,n){"use strict";n("5dc6")},ea97:function(e,t,n){"use strict";n("ec79")},ec79:function(e,t,n){},f121:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return i}));var a="";a=window.location.origin;var r=a,o="".concat(r,"/api"),u=[101,102,103,104,110],c={101:"UP",102:"CORRUPT",103:"MUMBLE",104:"DOWN",110:"CHECK FAILED","-1":"OFFLINE"},s={101:"#7dfc74",102:"#5191ff",103:"#ff9114",104:"#ff5b5b",110:"#ffff00","-1":"#fa83fc"},i="#ffffff",d=["#ffdf00","#c0c0c0","#d3983f"],f="#ffffff"},f1a4:function(e,t,n){"use strict";var a=n("d4ec"),r=n("bee2"),o=(n("b0c0"),function(){function e(t){var n=t.name,r=t.id;Object(a["a"])(this,e),this.name=n,this.id=r}return Object(r["a"])(e,null,[{key:"comp",value:function(e,t){return e.id-t.id}}]),e}());t["a"]=o}});
//# sourceMappingURL=app~d0ae3f07.1d312bcd.js.map